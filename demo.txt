# Vue加分名单生成系统需求规格说明书
## 一、文档概述
### 1.1 文档目的
明确Vue前端加分名单生成系统的核心功能、业务规则、界面要求及技术规范，为系统开发提供清晰依据，确保最终产品满足“无后端依赖、多数据源适配、按模板自动生成加分名单”的核心诉求，同时支持Python脚本辅助分析，提升大数据量处理效率。

### 1.2 适用范围
- 使用者：工学院负责学生加分统计的工作人员
- 应用场景：上传Excel数据源后，通过考勤验证、数据筛选，按标准模板导出活动/讲座类、比赛类加分名单，同步生成未考勤人员黑名单；支持Python脚本处理大数据量（≥3000行），提升效率
- 技术边界：纯Vue前端实现（基础功能）+ Python脚本（高效分析功能），无后端服务及数据库依赖，前端基于SheetJS处理Excel，脚本基于Pandas处理数据

## 二、核心需求总览
| 需求类别 | 核心目标 | 优先级 |
|----------|----------|--------|
| 文件上传解析 | 支持多Excel数据源上传，自动识别“数据源”工作表及15个核心字段 | 高 |
| 考勤验证与黑名单 | 区分已考勤（可加分）/未考勤（黑名单）人员，支持黑名单导出 | 高 |
| 模板自动匹配 | 按活动类型匹配对应模板（活动/讲座类、比赛类），严格遵循格式规范 | 高 |
| 多维度筛选 | 支持学年学期、活动名称、班级等维度筛选，配置加分规则 | 中 |
| 标准Excel导出 | 导出文件符合模板格式（列宽、行高、字体等），无需人工调整 | 高 |
| 可视化交互 | 界面简洁易用，提供数据统计、操作反馈、错误提示 | 中 |
| Python辅助脚本 | 提供3个核心脚本，高效处理大数据量解析、筛选、黑名单生成 | 中 |

## 三、详细功能需求
### 3.1 文件上传与解析模块
#### 3.1.1 上传功能
- 支持文件格式：仅兼容`.xlsx`格式Excel文件，拒绝其他格式并提示“请上传标准Excel文件（.xlsx）”
- 上传限制：单个文件大小≤10MB，支持批量上传（最多同时上传3个文件）
- 操作体验：显示上传进度条，上传失败时提示具体原因（如文件损坏、大小超限）

#### 3.1.2 数据解析规则
- 工作表识别：自动检测上传文件中是否存在“数据源”工作表，无则提示“请上传包含‘数据源’工作表的标准文件”
- 字段校验：必须包含15个核心列（序号、学年学期、是否为工学院举办、行政班级、学号、姓名、活动类型、活动名称、加分类型、加分分数、奖项、部门、负责人、联系电话、备注），缺失字段时明确提示“缺少XX列，请检查数据源格式”
- 数据处理：
  - 自动去重：按“班级+姓名+活动名称”去重，避免重复加分
  - 格式转换：加分分数转为数字类型，学号允许空值，姓名去除首尾空格
  - 有效性校验：过滤“姓名为空”“活动名称为空”的无效数据

#### 3.1.3 解析反馈
- 统计展示：解析完成后显示“成功解析XX行数据、涉及XX个班级、包含XX种活动类型、有效数据XX行”
- 数据预览：提供分页预览功能，展示解析后的核心字段（班级、姓名、活动名称、加分类型、加分分数）

### 3.2 考勤验证与黑名单模块
#### 3.2.1 考勤判断规则
- 核心逻辑：仅“已考勤”人员纳入加分名单，“未考勤”人员纳入黑名单
- 判断方式（默认支持以下2种，可配置）：
  1. 数据源“备注”列匹配：备注含“已考勤”“到场”“参与”关键词视为已考勤
  2. 外部考勤文件匹配：支持上传单独的考勤Excel文件（需包含“班级、姓名、考勤状态”列），自动关联匹配
- 异常处理：未匹配到考勤状态的人员默认归入黑名单，支持手动调整

#### 3.2.2 黑名单管理
- 生成规则：按“行政班级”分组统计未考勤人员，包含字段（班级、姓名、学号、未考勤原因）
- 操作功能：支持黑名单预览、Excel导出（文件命名：“20XX-20XX学年第X学期未考勤人员黑名单.xlsx”）
- 联动效果：黑名单人员自动排除在加分名单候选范围外，不可手动添加

#### 3.2.3 统计展示
- 数据概览：显示“总人数XX → 已考勤XX（可加分） → 未考勤XX（黑名单）”的统计卡片
- 班级分布：按班级展示已考勤/未考勤人数占比

### 3.3 模板匹配与格式规范模块
#### 3.3.1 模板自动匹配
- 匹配规则：
  - 活动类型为“活动”“讲座” → 匹配“活动与讲座类模板”
  - 活动类型为“比赛” → 匹配“比赛类模板”
- 模板预览：匹配后展示模板结构预览，标注关键格式要求

#### 3.3.2 格式规范要求（严格遵循demo模板）
| 模板类型 | 结构要求 | 格式参数 |
|----------|----------|----------|
| 活动/讲座类 | 双列布局（序号、班级、姓名） | 列宽：序号4.75、班级27、姓名8.25<br>行高：标题69、注释24.5、正文20<br>字体：微软雅黑，标题18号（居中）、注释12号（居中）、正文11号（居中） |
| 比赛类 | 单列布局（序号、班级、姓名、奖项、加分数） | 列宽：序号9.25、班级30、姓名17.25、奖项16.25、加分数7.25<br>行高：同活动类<br>字体：同活动类 |

#### 3.3.3 内容填充规则
- 标题生成：自动填充“20XX-20XX学年第X学期XXX（活动名称）加分名单”
- 注释生成：
  - 活动/讲座类：“注：以下同学每人加XX（加分类型）XX分”
  - 比赛类：“注：以下同学加XX（加分类型），具体分数如下”
- 序号生成：按“班级升序→姓名升序”自动生成连续序号，不重复、不空缺
- 特殊处理：其他学院人员自动排在名单末尾，标注“其他学院”

### 3.4 数据筛选与配置模块
#### 3.4.1 多维度筛选
- 筛选维度：
  - 时间维度：学年学期（下拉选择，如“2024-2025学年第二学期”）
  - 活动维度：活动类型（多选：活动、讲座、比赛）、活动名称（模糊搜索）
  - 加分维度：加分类型（单选：学业分、品德分）、加分分数范围（输入框，如1-3分）
  - 班级维度：行政班级（多选，支持搜索）
- 筛选操作：支持多维度组合筛选，实时更新筛选结果数量，提供“重置筛选”按钮

#### 3.4.2 加分规则配置
- 分数配置：支持按奖项自动匹配分数（可修改默认规则），默认规则：一等奖4分、二等奖3分、三等奖2分、优秀奖1分、参与奖0.5分
- 其他配置：勾选“是否包含其他学院人员”“是否按班级排序”

### 3.5 Excel导出模块
#### 3.5.1 导出功能
- 导出触发：筛选完成后，点击“导出加分名单”按钮触发导出
- 文件命名：严格遵循格式“202X-202X学年第X学期工学院XXX活动/比赛加分名单.xlsx”
- 导出内容：包含完整模板结构（标题、注释、人员列表、注意事项），无冗余字段

#### 3.5.2 兼容性要求
- 导出文件可在Microsoft Excel 2016及以上版本、WPS中正常打开，格式无错乱
- 支持导出后直接打印，无需手动调整页面设置

### 3.6 界面交互与体验模块
#### 3.6.1 界面流程
1. 首页：文件上传区域 + 操作指南（步骤图示）+ Python脚本下载入口
2. 解析页：数据统计 + 考勤验证 + 黑名单预览
3. 筛选页：筛选组件 + 结果预览 + 规则配置
4. 导出页：模板预览 + 导出按钮 + 格式检查提示

#### 3.6.2 交互优化
- 操作反馈：按钮点击、文件上传、导出等操作提供加载动画和结果提示
- 错误提示：明确标注错误原因及解决办法（如“字段缺失→检查数据源列名”）
- 操作历史：localStorage存储最近3次导出记录，支持重新导出
- 响应式设计：适配电脑端（分辨率≥1366×768），支持窗口缩放

### 3.7 Python辅助脚本模块（新增）
#### 3.7.1 脚本核心目标
- 针对大数据量场景（数据源≥3000行），提供比前端更快的处理效率（解析耗时≤1秒，筛选耗时≤0.5秒）
- 脚本独立运行，无需依赖Vue前端，支持Windows/Mac/Linux系统
- 输出结果与前端一致，可直接导入前端或单独使用

#### 3.7.2 脚本清单及功能要求
##### 脚本1：数据解析与考勤验证脚本（data_parser.py）
- 功能：批量解析多个Excel数据源，自动完成考勤验证和黑名单生成
- 输入：数据源Excel文件路径（支持单个文件/文件夹批量处理）、考勤规则配置文件（json格式，配置考勤判断关键词或外部考勤文件路径）
- 输出：
  - 解析后的有效数据文件（parsed_data.xlsx）
  - 未考勤人员黑名单（blacklist.xlsx）
  - 统计报告（report.txt，含各班级考勤率、数据完整性分析）
- 核心特性：支持10000行以上数据快速解析，自动跳过损坏文件，生成错误日志

##### 脚本2：多维度筛选脚本（data_filter.py）
- 功能：按指定维度筛选数据，支持复杂条件组合
- 输入：解析后的有效数据文件（parsed_data.xlsx）、筛选条件配置文件（json格式，配置学年学期、活动类型、班级等筛选规则）
- 输出：筛选后的候选加分名单（filtered_data.xlsx）
- 核心特性：支持正则匹配筛选（如班级模糊匹配）、批量筛选多组条件，生成筛选日志

##### 脚本3：加分名单生成脚本（list_generator.py）
- 功能：按模板生成标准加分名单Excel，严格遵循格式规范
- 输入：筛选后的候选加分名单（filtered_data.xlsx）、模板类型（参数指定：activity/lecture/competition）
- 输出：标准格式的加分名单（按模板命名规则命名）
- 核心特性：自动设置列宽、行高、字体格式，支持批量生成多个活动的加分名单

#### 3.7.3 脚本使用要求
- 运行环境：Python 3.8+，依赖库：pandas、openpyxl、json（提供requirements.txt文件，支持pip一键安装）
- 操作方式：命令行运行，支持参数传入（如`python data_parser.py --input ./data --config ./config.json`）
- 兼容性：输出文件与前端导出文件完全兼容，可交叉使用

## 四、技术实现要求
### 4.1 技术栈
- 核心框架：Vue 3（推荐Vite构建，提升编译速度）
- Excel处理：SheetJS（xlsx库，负责Excel解析与生成）
- UI组件库：Element Plus（提供上传、表格、筛选、弹窗等组件）
- 数据存储：localStorage（存储临时数据、操作历史，无数据库依赖）
- 样式方案：Scss（支持样式模块化）
- Python脚本：Python 3.8+，依赖pandas（数据处理）、openpyxl（Excel读写）、json（配置解析）

### 4.2 技术约束
- 无后端依赖：所有逻辑在前端或Python脚本中完成，不涉及接口请求
- 浏览器兼容：支持Chrome 90+、Edge 90+、Firefox 88+主流浏览器
- 脚本兼容：支持Windows 10+、MacOS 12+、Linux Ubuntu 20.04+
- 性能要求：前端解析1000-3000行数据耗时≤3秒，Python脚本解析≥3000行数据耗时≤1秒

### 4.3 安全要求
- 文件处理：前端仅在内存中处理Excel文件，Python脚本仅读取指定路径文件，不存储用户原始数据
- 数据隔离：不同用户的操作数据互不干扰，脚本运行日志自动清理

## 五、交付物清单
1. Vue项目源代码（含完整目录结构、配置文件、注释）
2. 可运行的静态文件（dist目录，支持直接部署）
3. 操作手册（含前端操作步骤、Python脚本安装及运行指南、常见问题排查）
4. 测试用例（含正常场景、异常场景、大数据量场景测试）
5. Python辅助脚本包（含3个核心脚本、requirements.txt、配置文件示例、运行说明）

## 六、补充说明
- 若数据源字段或考勤规则有变更，可通过前端配置文件或Python脚本配置文件修改，无需修改核心代码
- 支持模板扩展：后续新增模板类型时，可在前端模板配置目录或Python脚本模板目录中添加对应模板文件
- 维护成本低：纯前端+独立Python脚本架构，无需服务器部署及后端维护
- 脚本与前端协同：支持Python脚本处理后的数据导入前端，兼顾效率与可视化操作